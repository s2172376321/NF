<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ngrok 連結列表</title>
  <style>
    body{background:#f4f6fb;font-family:'Segoe UI','Microsoft JhengHei',Arial,sans-serif;margin:0;padding:0;}
    .container{max-width:480px;margin:60px auto;background:#fff;border-radius:18px;box-shadow:0 8px 32px rgba(60,72,88,.18);padding:40px 32px 32px;text-align:center;}
    h2{color:#2d3a4b;margin-bottom:32px;font-size:2.2em;letter-spacing:2px;}
    .btn-list{list-style:none;padding:0;margin:0;}
    .btn-list li{margin-bottom:24px;}
    .ngrok-btn{display:block;width:100%;padding:22px 0;font-size:1.3em;font-weight:600;color:#fff;background:linear-gradient(90deg,#3a7bd5 0%,#00d2ff 100%);border:none;border-radius:12px;box-shadow:0 4px 16px rgba(58,123,213,.12);text-decoration:none;transition:background .2s,transform .2s,box-shadow .2s;letter-spacing:1px;}
    .ngrok-btn:hover,.ngrok-btn:focus{background:linear-gradient(90deg,#005c97 0%,#363795 100%);transform:translateY(-2px) scale(1.03);box-shadow:0 8px 24px rgba(58,123,213,.18);outline:none;}
    .group-title{margin:24px 0 8px;text-align:left;font-weight:700;color:#fa541c;}
    ul.links{list-style:none;padding-left:0;margin:0 0 8px 0;text-align:left;}
    ul.links li{margin-bottom:8px;}
    ul.links a{color:#005c97;text-decoration:none;font-weight:600;}
    ul.links a:hover{text-decoration:underline;}
  </style>
</head>
<body>
  <div class="container">
    <h2>ngrok 連結</h2>

    <!-- 既有 ngrok 連結按鈕 -->
    <ul class="btn-list">
      <li><a class="ngrok-btn" href="https://6ca8-218-34-110-52.ngrok-free.app" target="_blank">冷凍庫庫存 (後端)</a></li>
      <li><a class="ngrok-btn" href="https://2966-218-34-110-52.ngrok-free.app" target="_blank">採收資料 &amp; 資材使用</a></li>
    </ul>

    <button id="showLinksBtn" class="ngrok-btn" style="margin-top:12px;padding:18px 0;">顯示領用連結</button>

    <div id="resultArea" style="margin-top:16px;"></div>
  </div>

  <script>
    const BASE_URL = 'https://6ca8-218-34-110-52.ngrok-free.app';
    const btn     = document.getElementById('showLinksBtn');
    const area    = document.getElementById('resultArea');

    btn.addEventListener('click', async () => {
      btn.disabled = true;
      btn.textContent = '載入中…';
      try {
        const res = await fetch(
          `${BASE_URL}/api/inventory/claim-links?ngrok-skip-browser-warning=true`,
          { headers:{ 'ngrok-skip-browser-warning':'true' } }
        );
        if (!res.ok) throw new Error('無法取得資料');
        const data = await res.json();   // [{id,text,link}]

        // 分組
        const groups = { '真空包':[], '業務包':[], '其他':[] };
        data.forEach(item=>{
          if(item.text.includes('真空包'))      groups['真空包'].push(item);
          else if(item.text.includes('業務包')) groups['業務包'].push(item);
          else                                   groups['其他'].push(item);
        });

        // 產生 HTML
        area.innerHTML = '';
        Object.keys(groups).forEach(key=>{
          if(!groups[key].length) return;
          const h = document.createElement('div');
          h.className = 'group-title';
          h.textContent = key;
          area.appendChild(h);

          const ul = document.createElement('ul');
          ul.className = 'links';
          groups[key].forEach(item=>{
            const li = document.createElement('li');
            const a  = document.createElement('a');
            // 把 + 換成兩個空白
            a.textContent = item.text.replace(/\+/g,'  ');
            a.href  = item.link;
            a.target= '_blank';
            li.appendChild(a);
            ul.appendChild(li);
          });
          area.appendChild(ul);
        });

      } catch(err){ alert('載入失敗：'+err.message); }
      finally{
        btn.disabled = false;
        btn.textContent = '顯示領用連結';
      }
    });
  </script>
</body>
</html>
